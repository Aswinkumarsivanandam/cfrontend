<!-- Header Start -->
<!-- <app-header></app-header> -->
<!-- Header End -->


<!-- Sidebar Start -->
<!-- <app-side-bar></app-side-bar> -->
<!-- Sidebar End -->
<div class="">
  <div class="">
    <div class=" d-flex align-items-center justify-content-between pb-2">
      <div>
        <h3>Email</h3>
      </div>
    </div>
    <!---------------------------------------Email Tabs--------------------------->
    <div class="documents-table ">
      <div class="row mx-1">
        <div class="header-nav tab-menu pl-0 d-flex align-items-center justify-content-between w-100">
          <div class="nav-right">
            <ul class="d-flex pl-0 m-0">
              <li class="nav-link active" [ngClass]="{active: Selected == 'sendEmail'}" (click)="selectSendEmailTab(1)">
                Send Email
              </li>
              <li class="nav-link active" [ngClass]="{active: Selected == 'emailTemplate'}"
                (click)="selectEmailTemplateTab(2)">
                Email Templates
              </li>
              <li class="nav-link active" [ngClass]="{active: Selected == 'manageEmails'}"
                (click)="selectmanageTemplateTab(3)">
                Manage Emails
              </li>
              <li class="nav-link active" [ngClass]="{active: Selected == 'addDomain'}"
                (click)="selectVerifyDomainTab(4)">
                Add Domain
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-------------------------Email Deliverablity-------------------->
    <div *ngIf="TabId == 4" class="mt-4">
      <!-- <h3>Email Deliverablity</h3>
 
      <small>To send mass email you will need to verify your domain and add a custom 'from' email. This process will
        authenticate emails you send out and provide the highest deliverablity possible.</small> -->
     
      <div class="mt-4">
        <h3>Add Domain</h3>
      
        <small>Add the domain that you would like to send emails from. For example, if your email is
          investors@greencaptial.com then the domain would be greencaptial.com. learn more</small>
        <br>

        <div class="divradius mt-3">
        <!----------------------------------Domain Table--------------------------------------->
        <table #tableInput class="documents-table bordertable" *ngIf="domainList.length > 0">
          <thead>
            <tr>
              <th scope="col" [appSort]="domainList" data-order="desc" data-name="name">Domain</th>
              <th scope="col" [appSort]="domainList" data-order="desc" data-name="createdOn">Date Added</th>
              <!-- <th scope="col">Status</th> -->
              <th scope="col">Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of domainList">
              <td>{{item.name}}</td>
              <td>{{item.createdOn | date: 'MMM dd, yyy'}}</td>
              <!-- <td>{{item.status == 1 ? 'Pending' : 'Unverified'}}</td> -->
              <td>
                <span class="action-icon" (click)="deleteConformation(item, 1)" data-toggle="modal"
                  data-target="#delConformationShow">
                  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000">
                    <path d="M0 0h24v24H0V0z" fill="none" />
                    <path
                      d="M16 9v10H8V9h8m-1.5-6h-5l-1 1H5v2h14V4h-3.5l-1-1zM18 7H6v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7z" />
                  </svg>
                </span>
              </td>
            </tr>
          </tbody>
        </table>
      
        <button class="button-outline m-3" (click)="addDomain()" data-toggle="modal" data-target="#addDomainShow">Add
          Domain</button>
      </div>
    </div>
    </div>
    <br>
    <!-------------------------Add From Email-------------------->
    <div *ngIf="TabId == 4" class="mt-3">
      <h3>Add From Email</h3>
     
      <small>Choose an email that will be recognized by your subscribers. You can add multiple from emails.</small>
      <br>
      <!----------------------------------From Email Table--------------------------------------->
      <div class="divradius mt-3">
      <table #tableInput class="documents-table bordertable" *ngIf="EmailList.length > 0">
        <thead>
          <tr>
            <th scope="col" [appSort]="EmailList" data-order="desc" data-name="emailId">Email</th>
            <th scope="col" [appSort]="EmailList" data-order="desc" data-name="fromName">From Name</th>
            <th scope="col" [appSort]="EmailList" data-order="desc" data-name="createdOn">Date Added</th>
            <!-- <th scope="col">Status</th> -->
            <th scope="col">Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of EmailList">
            <td>{{item.emailId}}</td>
            <td>{{item.fromName}}</td>
            <td>{{item.createdOn | date: 'MMM dd, yyy'}}</td>
            <!-- <td>{{item.status == 1 ? 'Pending' : 'Unverified'}}</td> -->
            <td>
              <span class="action-icon" (click)="EditEmail(item)" data-toggle="modal" data-target="#addFromEmailShow">
                <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24" fill="#03260A">
                  <path d="M0 0h24v24H0V0z" fill="none" />
                  <path
                    d="M14.06 9.02l.92.92L5.92 19H5v-.92l9.06-9.06M17.66 3c-.25 0-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29zm-3.6 3.19L3 17.25V21h3.75L17.81 9.94l-3.75-3.75z" />
                </svg>
              </span>
              <span class="action-icon" (click)="deleteConformation(item, 2)" data-toggle="modal"
                data-target="#delConformationShow">
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000">
                  <path d="M0 0h24v24H0V0z" fill="none" />
                  <path
                    d="M16 9v10H8V9h8m-1.5-6h-5l-1 1H5v2h14V4h-3.5l-1-1zM18 7H6v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7z" />
                </svg>
              </span>
            </td>
          </tr>
        </tbody>
      </table>
     
      <button class="button-outline m-3" (click)="addEmail()" data-toggle="modal" data-target="#addFromEmailShow">Add
        Email</button>
    </div>
  </div>
    <!---------------------------------Email Template ----------------------------->
    <div *ngIf="TabId == 2">
      <button *ngIf="!newTemplateShow" class="mb-3 button-outline" (click)="createNewTemplate()">Create Template</button>

      <div class="container-fluid emailtemplate" >
      <div class="row"  *ngIf="!newTemplateShow && TemplateList.length > 0 ">
        <div class="col-md-4 mb-4 " *ngFor="let item of TemplateList">
          <div class="divradius p-3 ">
          <div [innerHtml]="item.template | safeHtml" class="mb-3"></div>
          <button class="button-outline mr-3" (click)="templateEdit(item, 1)">Edit</button>
          <button class="button-outline-secondary" (click)="templateDelete(item)" data-toggle="modal" data-target="#delTemplateConformationShow">Delete</button>
        </div>
      </div>

      </div>
    </div>


      <div *ngIf="newTemplateShow && !CreateEmailTemplateShow" class="divradius p-4">
        <h3 class="mb-2">Create New Email Template</h3>
        <div>
          <div class="col">
            <span class="label color-primary-tint">Template Name<span class="validation-msg"> *</span></span>
            <input type="text" class="input-field" placeholder="Enter Template Name" [(ngModel)]="TemplateName"
              (blur)="onTemplateName()">
            <div *ngIf="TemplateNameError" class="validation-msg">
              <span *ngIf="TemplateNameError ">Template name is required</span>
            </div>
          </div>
          <div class="col mt-3">
            <span class="label color-primary-tint">Description<span class="validation-msg"> *</span></span>
            <input type="text" class="input-field" placeholder="Enter Discription" [(ngModel)]="TemplateDiscription"
              (blur)="onTemplateDiscription()">
            <div *ngIf="TemplateDiscriptionError" class="validation-msg">
              <span *ngIf="TemplateDiscriptionError ">Template discription is required</span>
            </div>
          </div>
          <button class="mt-4 button-outline"(click)="addTemplate()">Next</button>
        </div>
      </div>
      <div *ngIf="CreateEmailTemplateShow && newTemplateShow">
        <email-editor #editor (loaded)="editorLoaded($event)" (ready)="editorReady($event)"></email-editor>
      </div>
      <button *ngIf="CreateEmailTemplateShow && newTemplateShow" class="mt-3 button-outline" (click)="saveDesign()">Save Design</button>
      <button *ngIf="CreateEmailTemplateShow && newTemplateShow && addBtnShow" class="mt-3 button-outline" (click)="save()">Save</button>
      <button *ngIf="CreateEmailTemplateShow && newTemplateShow && UpdateBtnShow" class=" button-outline" (click)="Update()">Update</button>
    </div>

    <!-------------------------------------Send Email------------------------->
    <div *ngIf="TabId == 1">
      <app-send-email></app-send-email>
    </div>
    <!-------------------------------------Manage Email------------------------->
    <div *ngIf="TabId == 3">
      <app-manage-email></app-manage-email>
    </div>
  </div>
</div>

<!-------------------------------------Add Domain Modal----------------------------------------------->

<div class="modal modal_outer right_modal fade" id="addDomainShow" tabindex="-1" role="dialog"
  aria-labelledby="myModalLabel2" *ngIf="addDomainShow">
  <div class="modal-dialog" role="document">
    <div class="modal-content ">
      <div class="modal-header">
        <h3>Add New Domain</h3>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body get_quote_view_modal_body">

        <div class="modal-content pt-0">
          <div class="row mt-3">
            <div class="col">
              <label for="subject" class="">Domain Name<span class="validation-msg">*</span></label>
              <input [datoAutoFocus]="autofocus" type="text" class="input-field" placeholder="Enter New Domain"
                [(ngModel)]="domainName" (blur)="onDomainName()">
              <div *ngIf="domainNameError" class="validation-msg">
                <span>Please enter domain name</span>
              </div>
            </div>
          </div>
          <div class="row mt-3">
            <div class="col">
              <label for="subject" class="">Enter SMTP Host<span class="validation-msg">*</span></label>
              <input [datoAutoFocus]="autofocusSMTP" type="text" class="input-field" placeholder="Enter SMTP Host"
                [(ngModel)]="smtpHost" (blur)="onSMTPHost()">
              <div *ngIf="smtpHostError" class="validation-msg">
                <span>Please enter domain name</span>
              </div>
            </div>
          </div>

        

          <br>
          <div class="modal-footer">
            <button (click)="saveDomain()" class="button mr-3">Add</button>
          </div>

         

          
        </div>

      </div>
    </div>
  </div>
</div>
<!-- modal -->

<!-----------------------------------Delete Domain and Email Conformation PopUp ------------------------->

<div class="modal modal_outer right_modal fade" id="delConformationShow" tabindex="-1" role="dialog"
  aria-labelledby="myModalLabel2" *ngIf="delConformationShow">
  <div class="modal-dialog" role="document">
    <div class="modal-content ">
      <div class="modal-header">
        <h2 *ngIf="DeleteModalId == 1">Delete Domain</h2>
        <h2 *ngIf="DeleteModalId == 2">Delete Email</h2>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body get_quote_view_modal_body">
        <div class="modal-content pt-0" *ngIf="DeleteModalId == 1">
          Are you sure you want to permanently delete this domain?
        </div>
        <div class="modal-content pt-0" *ngIf="DeleteModalId == 2">
          Are you sure you want to permanently delete this email?
        </div>

        <div class="modal-footer">
          <button id="portfolio_distributionhisdelshow_yes" class="button-outline mr-3" (click)="DeleteItems()"
            data-dismiss="modal">Yes</button>
          <button id="portfolio_distributionhisdelshow_no" type="button" class="button"
            (click)="delConformationShow=false" data-dismiss="modal">
            <span>No</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-----------------------------------Add From Email Modal------------------->

<div class="modal modal_outer right_modal fade" id="addFromEmailShow" tabindex="-1" role="dialog"
  aria-labelledby="myModalLabel2" *ngIf="addFromEmailShow">
  <div class="modal-dialog" role="document">
    <div class="modal-content ">
      <div class="modal-header">
        <h3>{{ModalName}} From Email</h3>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="addEmailCancel()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body get_quote_view_modal_body">
        <div class="modal-content pt-0">
          <div class="row mt-3">
            <div class="col">
              <label for="subject" class="">From Name<span class="validation-msg">*</span></label>
              <input [datoAutoFocus]="autofocus" type="text" class="input-field" placeholder="Enter From Name"
                [(ngModel)]="FromName" (blur)="onFromName()">
              <div *ngIf="fromNameError" class="validation-msg">
                <span>Please enter from name</span>
              </div>
            </div>
          </div>
          <div class="row mt-3">
            <div class="col">
              <label for="subject" class="">Enter Email Address<span class="validation-msg">*</span></label>
              <input [datoAutoFocus]="autofocus1" type="text" class="input-field" placeholder="Enter Username"
                [(ngModel)]="EmailAddress" (blur)="onEmailAddress()">

              <div class="emailsymbol">@</div>
              <div *ngIf="emailAddressError" class="validation-msg">
                <span>Please enter username</span>
              </div>
            </div>
            <div class="col ptop">
              <select class="input-field" name="type" *ngIf="ModalName == 'Add'" (change)="onchangeEmailMethod($event)"
                [(ngModel)]="emailDomainId">
                <option *ngFor="let item of EmailDomainList" [value]="item.id" [selected]="item.id == emailDomainId">
                  {{ item.name }}
                </option>
              </select>
              <select class="input-field" name="type" *ngIf="ModalName == 'Update'" disabled="true"
                [(ngModel)]="emailDomainId">
                <option *ngFor="let item of EmailDomainList" [value]="item.id" [selected]="item.id == emailDomainId">
                  {{ item.name }}
                </option>
              </select>
            </div>
          </div>
          <div class="row mt-3">
            <div class="col">
              <label for="password" class="">Password<span class="validation-msg">*</span></label>
              <input [type]="showPassword ? 'text' : 'password'" [datoAutoFocus]="autofocusPassword" class="input-field" placeholder="Enter Password"
                [(ngModel)]="Password" (blur)="onPassword()">
                <span class="input-field-btn view-pwd">
                  <button id="email_rf_showpassword" class="button button-clear icon-only" (click)="ViewPassword()" type="button">
                    <svg *ngIf="showPassword" xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 0 24 24"
                      width="20">
                      <path d="M0 0h24v24H0V0z" fill="none" />
                      <path
                        d="M12 6c3.79 0 7.17 2.13 8.82 5.5C19.17 14.87 15.79 17 12 17s-7.17-2.13-8.82-5.5C4.83 8.13 8.21 6 12 6m0-2C7 4 2.73 7.11 1 11.5 2.73 15.89 7 19 12 19s9.27-3.11 11-7.5C21.27 7.11 17 4 12 4zm0 5c1.38 0 2.5 1.12 2.5 2.5S13.38 14 12 14s-2.5-1.12-2.5-2.5S10.62 9 12 9m0-2c-2.48 0-4.5 2.02-4.5 4.5S9.52 16 12 16s4.5-2.02 4.5-4.5S14.48 7 12 7z" />
                    </svg>
                    <svg *ngIf="!showPassword" xmlns="http://www.w3.org/2000/svg" height="20"
                      viewBox="0 0 24 24" width="20">
                      <path d="M0 0h24v24H0V0zm0 0h24v24H0V0zm0 0h24v24H0V0zm0 0h24v24H0V0z" fill="none" />
                      <path
                        d="M12 6c3.79 0 7.17 2.13 8.82 5.5-.59 1.22-1.42 2.27-2.41 3.12l1.41 1.41c1.39-1.23 2.49-2.77 3.18-4.53C21.27 7.11 17 4 12 4c-1.27 0-2.49.2-3.64.57l1.65 1.65C10.66 6.09 11.32 6 12 6zm-1.07 1.14L13 9.21c.57.25 1.03.71 1.28 1.28l2.07 2.07c.08-.34.14-.7.14-1.07C16.5 9.01 14.48 7 12 7c-.37 0-.72.05-1.07.14zM2.01 3.87l2.68 2.68C3.06 7.83 1.77 9.53 1 11.5 2.73 15.89 7 19 12 19c1.52 0 2.98-.29 4.32-.82l3.42 3.42 1.41-1.41L3.42 2.45 2.01 3.87zm7.5 7.5l2.61 2.61c-.04.01-.08.02-.12.02-1.38 0-2.5-1.12-2.5-2.5 0-.05.01-.08.01-.13zm-3.4-3.4l1.75 1.75c-.23.55-.36 1.15-.36 1.78 0 2.48 2.02 4.5 4.5 4.5.63 0 1.23-.13 1.77-.36l.98.98c-.88.24-1.8.38-2.75.38-3.79 0-7.17-2.13-8.82-5.5.7-1.43 1.72-2.61 2.93-3.53z" />
                    </svg>
                  </button>
                </span>
              <div *ngIf="passwordError" class="validation-msg">
                <span>Please enter password</span>
              </div>
            </div>
          </div>
          <br>
          <div class="modal-footer">
            <button (click)="saveEmail()" class="button mr-3">{{ModalName}}</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-------------------------------------Create Template----------------------------------------------->

<div class="modal modal_outer right_modal fade" id="createTemplateShow" tabindex="-1" role="dialog"
  aria-labelledby="myModalLabel2" *ngIf="createTemplateShow">
  <div class="modal-dialog" role="document">
    <div class="modal-content ">
      <div class="modal-header">
        <h3>Create Template</h3>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body get_quote_view_modal_body">

        <div class="modal-content pt-0">
          <div class="row mt-3">
            <div class="col">
              <button (click)="createNewTemplate()">Create New Template</button>
            </div>
          </div>
          <br>
        </div>

      </div>
    </div>
  </div>
</div>

<!-----------------------------------Delete Template Conformation PopUp ------------------------->

<div class="modal modal_outer right_modal fade" id="delTemplateConformationShow" tabindex="-1" role="dialog"
  aria-labelledby="myModalLabel2" *ngIf="delTemplateConformationShow">
  <div class="modal-dialog" role="document">
    <div class="modal-content ">
      <div class="modal-header">
        <h2>Delete Template</h2>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="delTemplateConformationShow = false">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body get_quote_view_modal_body">
        <div class="modal-content pt-0" >
          Are you sure you want to permanently delete this template?
        </div>
        <div class="modal-footer">
          <button id="portfolio_distributionhisdelshow_yes" class="button-outline mr-3" (click)="DeleteTemplateItems()"
            data-dismiss="modal">Yes</button>
          <button id="portfolio_distributionhisdelshow_no" type="button" class="button"
            (click)="delTemplateConformationShow=false" data-dismiss="modal">
            <span>No</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-------------Loader-------------->

<div class="loader" *ngIf="Loader">
  <div class="loaderimgdiv"><img class="loaderimg" src="../../assets/images/loader.gif"></div>
</div>